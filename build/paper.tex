\documentclass[]{assets/latex/ieee}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[unicode=true]{hyperref}
\hypersetup{
            pdftitle={Browsernative Microservices},
            pdfauthor={Jan Peteler, FH Würzburg-Schweinfurt, jan.peteler@student.fhws.de},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\newenvironment{Shaded}{}{}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
\newcommand{\ImportTok}[1]{{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
\newcommand{\BuiltInTok}[1]{{#1}}
\newcommand{\ExtensionTok}[1]{{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
\newcommand{\RegionMarkerTok}[1]{{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
\newcommand{\NormalTok}[1]{{#1}}
\usepackage[normalem]{ulem}
% avoid problems with \sout in headers with hyperref:
\pdfstringdefDisableCommands{\renewcommand{\sout}{}}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother


\title{Browsernative Microservices}
\providecommand{\subtitle}[1]{}
\subtitle{Modular web architecture through new W3C specifications}
\author{Jan Peteler, FH Würzburg-Schweinfurt, jan.peteler@student.fhws.de}
\date{Januar 2017}

\begin{document}
\maketitle
\begin{abstract}
Building complex web applications nowadays require additional layers of
abstraction and often heavily depend on proprietary frameworks. New
specifications build right into the browserengine provide a native
service API to overcome tricky abstraction constraints.
\end{abstract}

\section{Introduction}\label{introduction}

\begin{quote}
Simplicity is prerequisite for reliability. - Edsger W. Dijkstra
\end{quote}

Introduction: from simplicity to Microservices to extensible web
manifesto to w3c specifications \ldots{} and beyond

Der Erfinder der Programmiersprache Clojure, Rich Hickey, ist ohne
Zweifel eine Koryphäe auf seinem Gebiet, der Strukturierung von
komplexen Systemen. In einer vielbeachteten Keynote aus dem Jahr 2012
geht er auf etymologisch-philosophische Spurensuche nach dem Wort
\textbf{simplicity } aus Sicht eines Softwareentwicklers.\footnote{\href{https://www.youtube.com/watch?v=rI8tNMsozo0\&t=48s}{Rails
  Conf 2012 Keynote: Simplicity Matters by Rich Hickey}} Das Adjektiv
\emph{simple} hat demnach seinen Ursprung im lateinischen Wort
\emph{simplex}, was soviel wie \emph{einfach} oder \emph{einzeln}
bedeutet. In Gegensatz dazu stehen Eigenschaften wie \emph{complex} oder
\emph{multiplex}. Qualitative Software ist, so Hickey, vor allem simpel
- im Prozess, im Design, in der Struktur und in der Entwicklung.

Bezeichnend für diese Keynote ist, dass sie von Rich Hickey im Rahmen
einer Webentwicklerkonferenz gehalten wurde. Software für den Browser
war (und ist) seit langer Zeit maßgeblich geprägt von
\textbf{Komplexität} auf mehreren Ebenen. Im Laufe dieser Bachelorarbeit
werden diese Stru

\begin{itemize}
\tightlist
\item
  Das \emph{Document Object Model} als Rückgrad jeder Webapplikation ist
  hierarchisch strukturiert und deren Elemente damit keinesfalls
  unabhängig in ihrer Darstellung und Reihenfolge.
\item
  JavaScript als single-threaded Skriptsprache lässt sich schlecht ihn
  ihrem Verhalten isolieren, ist Fehleranfällig und hatte lange Zeit nur
  sehr wenig idiomatische Lösungsansätze für komplexe Probleme, wie
  beispielsweise Asynchronität
\item
  CSS ist geprägt von stetigem Überschreiben vorher definierter Regeln
  und verletzt damit Simplizität in ihrer Struktur, Design und dem
  Entwicklungsprozesses auf bester Art und Weise.
\end{itemize}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

Betrachtet man andere populäre Webframeworks dieser Zeit, wie
beispielsweise React oder Angular, lässt sich ziemlich schnell ein
gemeinsames Designpattern ausmachen, wie Komponenten intern ihre
Zuständen verwalten. Der Facebook Entwickler Dan Abramov hat dieses
dichotome Pattern systematisch erfasst und in zwei Kategorien
eingeteilt.

Nach Abramov existieren zum einen Komponenten, die alleine für das
\textbf{Darstellen von Information} zuständig sind. Diese Komponenten
nehmen keinerlei Einfluss auf Informationen oder anderen Komponenten um
sich herum. Sie sind im wahrsten Sinne passiv und fremdgesteuert über
klar definierte Schnittstellen. Diese Komponenten sind häufig flexibel
einsetzbar und hochgradig wiederwerwendbar. Abramov nennt diese
Komponenten ``Presentational Components''.{[}1{]} Verortet man diese Art
von Komponenten innerhalb des \emph{MVC Pattern}, sind die Komponenten
reine \emph{View-Elemente}.

Im Gegensatz dazu stehen Komponenten, die für die \textbf{Verarbeitung
von Informationen} zuständig sind. Diese so genannten ``Container
Components'' haben oft einen internen Zustand, den sie verändern können
und an ihre Kindkomponenten weiterreichen können.{[}1{]} Im \emph{MVC
Pattern} handelt es sich um die \emph{Controller}. In der funktionalen
Programmiersprache Elm werden diese Elemente \emph{Updater} genannt, was
ihre Funktion noch besser umschreibt.

Ein üblicher eventgesteuerter Webservice setzt sich aus
unterschiedlichsten Komponenten zusammen, die wiederum
unterschiedlichste Eventlistener \& -emitter in sich subsummieren. Diese
inhärente Komplexität verlangt geradezu nach einer klaren,
deterministischen Struktur des Webservices, die das Zusammenspiel
orchestriert. In der Analogie des Orchesters gesprochen, benötigt der
Webservice (oder sogar die gesamte Webapplikation) einen Dirigenten, der
für die Steuerung verantwortlich ist.

\section{Microservices}\label{microservices}

Opening up the case for \emph{Browsernative Microservices} brings up the
question about the concept microservices in general. In fact the concept
of microservices has many facets, stretching beyond disciplines and
technical boundaries. It lacks a formal standardization but there are
certain ideas emergine from this pattern. As a primary source of truth
this articles relies on the work of Sam Newman, who has written a
comprehensive guide in \emph{Building Microservices}. The purpose of
this section is to match those ideas against the manifestations of web
components.

In a nutshell a microservice is a small, autonomous service that works
together with other services seamlessly.{[}2, p. 2{]} or with the words
of Fowler and Lewis: ``It is an approach to developing a single
application as a suite of small services, each running in its own
process and communicating with lightweight mechanisms,\ldots{}''{[}3{]}
Microservices incorporate many ideas, like \emph{domain-driven design}
where we try to represent the real world in our code.{[}2, p. 2{]} Or
making use of \emph{continuous delivery} for pushing software rapidly
through \emph{automated deployment} mechanisms in production.{[}3{]}
And, last but not least, microservices utilizes the idea of small teams
with a lot of product knowledge working mostly autonomous on their very
own service with their very own set of tools and techniques.

\subsection{Technical perspective}\label{technical-perspective}

Shift of paradigms / BFF / Platform agnostic / changes in infrastructure
like APIs Databanks / Deployment

Talking about microservices in a browsernative context isn't that far
fetched as microservices themselves incorporate many ideas from the web.
Exemplary, microservices often communicate via an HTTP request-response
with resource API's and lightweight messaging.{[}3{]} Nevertheless,
while (server-side) microservices offer wide ranges of technical
possibilities, we must take into account that (client-side) browsers
come with certain constraints and limitations.

Fowler and Lewis issue a call for using services as components. A
component~is regarded as a unit of software that is independently
replaceable and upgradeable. The main advantage of a component in
contrast of library is the possibility of an independent deployment. It
aligns perfectly with the main goal of a microservice architecture to
strip away most of the dependencies in favour of clean
interfaces.{[}3{]}

Components

First of all, from a technical perspective, a microservice reinforces
the \emph{Single Responsibility Principle} defined by Robert C. Martin:
``Gather together those things that change for the same reason and
separate those things that change for different reasons.''{[}4{]} An a
way this principle tackles another often cited design principle of the
\emph{seperation of concerns}. Web Components incorporate this principle
in multiple ways while still remaining flexible.

Most obvious ist the gathering of all related code under the umbrellar
of a single HTML tag. Grouping together HTML, JS and CSS Code in a safe,
sandboxed environment exposes the possibility to build more cohesive and
understandable services. In the typical global nature of web development
those three pillars are separated. This circumstance left the developer
switching back and forth between code bases developing a tricky (and
sometimes biased) way to glue related parts together.

Secondly, the sub-standard \emph{custom elements} introduces so called
lifecycle methods and a getter/setter interface exposing the
functionality to the developer. Event handling, for example, can be
registered in place which is much more declarative than assigning event
listeners from the outside. Of course, this events can be pushed down to
nested tags, allowing an increasingly granular system design. This
approach will be explained further in the upcoming sections.

The concept of microservices incooperates not only a technical
perspective. Microservice patterns are a product of real-world
usage.{[}2, p. 1{]} In a real world we typical have to deal with the so
called \emph{Conway's Law}:

\begin{quote}
``organizations which design systems \ldots{} are constrained to produce
designs which are copies of the communication~structures~of these
organizations''. {[}5{]}
\end{quote}

Following this logic any company, whether it is web-related or not,
should be devided in units grouped around a destinct business service to
optimise the workflow. Fowler and Lewis outlines this approach as an
``alignment of business capabilities''{[}3{]} While this kind of
structure may be true for companies like Google or Amazon, there is a
vast majority of companies developing for the web which are grouped
around tasks.{[}6{]} A very common structure is formed by the technology
stack (UX Designers, Frontend- \& Backend Developers) or by separating
teams along the product lifecycle (development, testing, deployment).

Advocators from the microservice approach propose a different model.
best described by . Web components are one (but important) way to tie up
those diciplines as one component can host a single independent business
service. Combined with a flexible backend service these components can
be huge gain over the cumbersome functional organizational approach.

The ideas transcending from the microservice approach offers plenty of
choices and decisions how to proceed with designing a program or to
structure a process.

\section{W3C specifications}\label{w3c-specifications}

For building a native microservice running on the ``bare-metal'' browser
engine requires a bunch of new specifications and assumptions. Most
importantly the quasi specification \textbf{Web Components} is needed.
\emph{Web Components} is not a real standard. It's an amalgam of APIs
from multiple w3c specs which can be used independently, too. A
webdeveloper may choose one spec and embrace the freedom in architecture
which can be combined with other frameworks/libraries.

Depending on the context, some people argue for only two specs which
essentially make it possible to create a scoped component but not caring
too much on it's distribution{[}7{]}. Some people prefer the three specs
{[}8{]}, but the majority advocating the four specs variant, which is
listed on \sout{the official}
\href{http://webcomponents.org}{webcomponents.org} website. For the
purpose of this article, all four specs will be discussed briefly to
provide a rough understanding. It is not meant to cover all bits and
pieces.

\subsection{\texorpdfstring{Custom Elements
\href{http://w3c.github.io/webcomponents/spec/custom/}{(w3c)}}{Custom Elements (w3c)}}\label{custom-elements-w3c}

\emph{Custom elements} are the fundamental building blocks for web
components. Essentially, they provide a way to create custom HTML tags
enriched with behavior, design and functionality. An obligatory
\textbf{HelloWorld} will help to grasp the spec:

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{>} \VariableTok{main}\NormalTok{.}\AttributeTok{js}
\KeywordTok{class} \NormalTok{HelloWorld }\KeywordTok{extends} \NormalTok{HTMLElement }\OperatorTok{\{}
  \AttributeTok{constructor}\NormalTok{() }\OperatorTok{\{}
    \KeywordTok{super}\NormalTok{()}\OperatorTok{;} \CommentTok{// mandatory!}
    \KeywordTok{this}\NormalTok{.}\AttributeTok{onclick} \OperatorTok{=} \NormalTok{e }\OperatorTok{=>} \AttributeTok{alert}\NormalTok{(}\StringTok{"hello"}\NormalTok{)}\OperatorTok{;}
    \KeywordTok{this}\NormalTok{.}\AttributeTok{addEventListener}\NormalTok{(...)}\OperatorTok{;}
  \OperatorTok{\}}
\OperatorTok{\}}
\VariableTok{customElements}\NormalTok{.}\AttributeTok{define}\NormalTok{(}\StringTok{'hello-world'}\OperatorTok{,} \NormalTok{HelloWorld)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{> index.html}
\KeywordTok{<hello-world>}\NormalTok{say hello}\KeywordTok{</hello-world>}
\end{Highlighting}
\end{Shaded}

Most obvious, this spec relies on the new \emph{ES6 Class Syntax} in
favor of the original prototype-based inheritance model.
``Extending~\texttt{HTMLElement}~ensures the custom element inherits the
entire DOM API and means any properties/methods that you add to the
class become part of the element's DOM interface.''{[}9{]} Like any
other \emph{ES6 class}, \emph{custom element}s can be sub-classed
further on with the typical \texttt{extends} inheritance.

The beauty of \emph{custom elements} comes with the keyword
\texttt{this} which points to the element itself. Instead of querying
and assigning behavior AFTER creation of the node in question
\texttt{this} functionality allows a \textbf{declarative programming
style}. Assigning functionality happens right in place BEFORE creation
or insertion of the DOM. The so called \emph{fat-arrow}
(\texttt{=\textgreater{}}) is just a new feature of ES6 and nothing more
than an anonymous \texttt{function()}.

After definition, the element needs to be registered in the new global
build-in \texttt{customElements} with an tag name like
\texttt{\textless{}hello-world\textgreater{}}. Mind the dash inside the
tag name to conform the spec. Finally, the new element can go live
inside the HTML Document \texttt{index.html}.

\subsubsection{Lifecycle methods}\label{lifecycle-methods}

In addition to the \texttt{constructor()}, the spec defines so called
\emph{lifecycle callbacks} for controlling the \textbf{behaviour in the
DOM}. Many popular frameworks like ReactJS or AngularJS rely on similar
approaches:

\begin{itemize}
\tightlist
\item
  \texttt{connectedCallback()}\\
  Called upon the time of \emph{connecting or upgrading the node} which
  means the moment the node is inserted and rendered inside the DOM.
  Typically this block of code contains setup code, such as fetching
  resources or rendering.{[}9{]} For performance issues it's highly
  preferable to put much code in here.
\item
  \texttt{disconnectedCallback()}\\
  Called upon the time of \emph{node removal}. Cleanup code like
  removing eventListeners or disconnecting websockets can be put here.
\item
  \texttt{attributeChangedCallback(attrName,\ oldVal,\ newVal)}\\
  This method provides an \emph{Onchange handler} that runs for certain
  attributes called with three values as defined in the signature. It is
  meant to control an elements' transition from on \texttt{oldVal} to a
  \texttt{newVal}. Due to performance issues, this callback is only
  triggered for attributes registered in an \emph{observedAttributes}
  array.
\item
  \texttt{adoptedCallback()}\\
  Called when moving the node \emph{between documents}.
\end{itemize}

\subsubsection{Custom attributes}\label{custom-attributes}

As previously mentioned, the custom elements must \texttt{extend} the
\texttt{HTMLElement}. Consequently, the new element inherits properties
and methods from it (and it's parent \texttt{Element}) and things like
\texttt{id,\ class,\ addEventListner,\ ...} run out-of-the-box.
Additionally, it is possible to define custom attributes using the
\emph{custom elements'} \textbf{getter / setter interface} to steer the
behavior of the element.

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{>} \VariableTok{main}\NormalTok{.}\AttributeTok{js}
\KeywordTok{class} \NormalTok{HelloWorld }\KeywordTok{extends} \NormalTok{HTMLElement }\OperatorTok{\{}
  \NormalTok{...}
  \NormalTok{set }\AttributeTok{sayhello}\NormalTok{(val) }\OperatorTok{\{}
    \KeywordTok{this}\NormalTok{.}\AttributeTok{_hello} \OperatorTok{=} \NormalTok{val}\OperatorTok{;}
    \VariableTok{console}\NormalTok{.}\AttributeTok{log}\NormalTok{(}\KeywordTok{this}\NormalTok{.}\AttributeTok{_hello}\NormalTok{)}\OperatorTok{;}
  \OperatorTok{\}}
  \NormalTok{get }\AttributeTok{sayhello}\NormalTok{() }\OperatorTok{\{}
    \ControlFlowTok{return} \KeywordTok{this}\NormalTok{.}\AttributeTok{_hello}\OperatorTok{;}
  \OperatorTok{\}}
\OperatorTok{\}}
\VariableTok{customElements}\NormalTok{.}\AttributeTok{define}\NormalTok{(}\StringTok{'hello-world'}\OperatorTok{,} \NormalTok{HelloWorld)}\OperatorTok{;}
\KeywordTok{var} \NormalTok{el }\OperatorTok{=} \KeywordTok{new} \AttributeTok{HelloWorld}\NormalTok{()}\OperatorTok{;}
\VariableTok{el}\NormalTok{.}\AttributeTok{sayhello} \OperatorTok{=} \StringTok{"earth"}\OperatorTok{;}
\VariableTok{el}\NormalTok{.}\AttributeTok{sayhello}\OperatorTok{;}\CommentTok{//"earth"}
\end{Highlighting}
\end{Shaded}

While getters and setters work great in the JS world they fail crossing
the boundaries to the corresponding HTML node. Declaring
\texttt{\textless{}hello-world\ sayhello="mars"\textgreater{}\textless{}/hello-world\textgreater{}}
would't work in the previous setup. A common workaround is archived by
using the previous mentioned \texttt{attributeChangedCallback} lifecycle
method to \textbf{reflect changing HTML attributes to JS} and/or map JS
attributes to HTML with \texttt{this.setAttributes(...)} respectively.
On \textbf{insertion time} html attributes might raise their hand with
\texttt{this.hasAttributes(...)} and \texttt{this.getAttributes(...)}.
Native DOM properties will reflect their values between HTML and JS
automatically.{[}10, Para. 2.6.1{]}

Concluding this section, a reader might already discover the
\textbf{mental model} behind \emph{web compontents}. A custom element is
similar to a named function where attributes treated as \textbf{input
variables}. In the hierarchical nature of DOM, input can occur either
top-down via assignments and bottom-up via captured events. The same
goes true when talking about output. Even though it seems obvious, it
might be helpful to keep this point in mind.

\subsubsection{Customized build-in
elements}\label{customized-build-in-elements}

One aspect didn't mentioned yet is the possibility of creating
sub-classes of \textbf{build-in elements} by extending the native
Interfaces like the \texttt{HTMLButtonElement} interface. While this
functionality is perfectly spec'd it is strongly rejected by some
browser vendors.\footnote{Discussion on the topic:
  https://github.com/w3c/webcomponents/issues/509} Most likely the spec
will change in future in one or other way on this issue and therefore
\textbf{customized build-in elements} left out of this paper
intentionally.

\subsection{\texorpdfstring{Shadow DOM
\href{http://w3c.github.io/webcomponents/spec/shadow/}{(w3c)}}{Shadow DOM (w3c)}}\label{shadow-dom-w3c}

The second most important concept of \emph{web components} rewards to
the \emph{shadow DOM} spec. The concept isn't the easiest to wrap ones
head around. Basically it's an isolated DOM tree living inside an
hosting DOM tree. The spec referencing the hosting tree as \textbf{light
tree} and the attached DOM as \textbf{shadow tree}. Conceptually, the
Shadow DOM issues a single topic: \textbf{Style Encapsulation}.

With an ever increasing complexity of an single-page application, the
global nature of the DOM creates a challenging situation for the web
developer and often ends up in highly fragmented bits of CSS and obscure
CSS selectors. Of course, this situation lowers code clarity and
reusability dramatically. The only solution which won't break with the
existing global paradigm effectively is to allow separate pieces of
encapsulated code sit on top of the global DOM - introducing the
shadowed DOM approach!

Enhancing the previous example the new encapsulated \texttt{HelloWorld}
would like this:

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{>} \VariableTok{main}\NormalTok{.}\AttributeTok{js}
\KeywordTok{class} \NormalTok{HelloWorld }\KeywordTok{extends} \NormalTok{HTMLElement }\OperatorTok{\{}
  \AttributeTok{constructor}\NormalTok{() }\OperatorTok{\{}
    \KeywordTok{super}\NormalTok{()}\OperatorTok{;} \CommentTok{// mandatory!}
    \KeywordTok{const} \NormalTok{shadowRoot }\OperatorTok{=}
          \KeywordTok{this}\NormalTok{.}\AttributeTok{attachShadow}\NormalTok{(}\OperatorTok{\{}\DataTypeTok{mode}\OperatorTok{:} \StringTok{'open'}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
    \VariableTok{shadowRoot}\NormalTok{.}\AttributeTok{innerHTML} \OperatorTok{=} \StringTok{"hello"}\OperatorTok{;}
    \KeywordTok{this}\NormalTok{.}\AttributeTok{onclick} \OperatorTok{=} \NormalTok{e }\OperatorTok{=>} \AttributeTok{alert}\NormalTok{(}\StringTok{"hello"}\NormalTok{)}\OperatorTok{;}
  \OperatorTok{\}}
\OperatorTok{\}}
\end{Highlighting}
\end{Shaded}

The new global method \texttt{attachShadow} adds a new document root to
the \texttt{HelloWorld} which has the same properties as a normal DOM.
Therefore, it's possible to call the \texttt{innerHTML} method to fill
the new document (fragment) with some content. Note that shadowRoot is
attached as \textbf{open} which ensures that some events can bubble out
and outside JS can reach in the new root. Nested children and other
content in the light DOM are ``shadowed'' by the new root and must be
invited in by so called \texttt{slots}.

\subsubsection{Slots}\label{slots}

Macroperspektive / Composition

\subsubsection{Assumptions about custom
elements}\label{assumptions-about-custom-elements}

Apart from the spec'd perspective there is mental model a webdeveloper
might

Creating and using webcomponents might require a new mental model how do
design a

containers

http://alistair.cockburn.us/Hexagonal+architecture

MVC Pattern

Pure frontend vs heavy backend

\section{Progressive Enhancement}\label{progressive-enhancement}

Chapter about progressive enhancement

\hypertarget{refs}{}
\hypertarget{ref-Abramov2015}{}
{[}1{]} D. Abramov, ``Presentational and Container Components --
Medium.'' 2015 {[}Online{]}. Available:
\url{https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0}.
{[}Accessed: 01-Dec-2016{]}

\hypertarget{ref-Newman2015}{}
{[}2{]} S. Newman, \emph{Building microservices}. O'Reilly Media, Inc.,
2016 {[}Online{]}. Available:
\url{http://www.ebook.de/de/product/22539693/sam_newmann_building_microservices.html}

\hypertarget{ref-Fowler2014}{}
{[}3{]} M. Fowler and J. Lewis, ``Microservices: A definition of this
new architectural term,'' Jan. 2014 {[}Online{]}. Available:
\url{http://www.martinfowler.com/articles/microservices.html}

\hypertarget{ref-Martin}{}
{[}4{]} R. C. Martin, ``The single responsibility principle.''
{[}Online{]}. Available:
\url{http://programmer.97things.oreilly.com/wiki/index.php/The_Single_Responsibility_Principle}

\hypertarget{ref-Conway1968}{}
{[}5{]} M. E. Conway, ``How do committees invent?'' 1968 {[}Online{]}.
Available: \url{http://www.melconway.com/Home/Committees_Paper.html}

\hypertarget{ref-Issa2016}{}
{[}6{]} B. Issa, ``The way of the web.'' Polymer Summit 2016, Oct-2016
{[}Online{]}. Available:
\url{https://www.youtube.com/watch?v=8ZTFEhPBJEE}

\hypertarget{ref-Buchner2016}{}
{[}7{]} D. Buchner, ``Demythstifying web components,'' 2016
{[}Online{]}. Available:
\url{http://www.backalleycoder.com/2016/08/26/demythstifying-web-components/}

\hypertarget{ref-vanKesteren2014}{}
{[}8{]} A. van Kesteren, ``Mozilla and web components: Update,'' 2014
{[}Online{]}. Available:
\url{https://hacks.mozilla.org/2014/12/mozilla-and-web-components/}

\hypertarget{ref-Bidelman2016}{}
{[}9{]} E. Bidelman, ``Custom elements v1: reusable web components.''
2016 {[}Online{]}. Available:
\url{https://developers.google.com/web/fundamentals/primers/customelements/}.
{[}Accessed: 01-Dec-2016{]}

\hypertarget{ref-HTML}{}
{[}10{]} \emph{HTML living standard --- last updated 11 january 2017}.
{[}Online{]}. Available: \url{https://html.spec.whatwg.org/multipage/}

\end{document}
